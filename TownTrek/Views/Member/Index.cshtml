@model TownTrek.Models.ViewModels.MemberDashboardViewModel
@{
    ViewData["Title"] = "Discover Local Businesses";
    Layout = "_Layout";
}

<div class="member-dashboard">
    <!-- Welcome Section -->
    <section class="hero-section-member">
        <div class="container">
            <h1 class="hero-title">Welcome back, @Model.UserName!</h1>
            <p class="hero-subtitle">
                Discover amazing local businesses across South African towns. Find, review, and support your community.
            </p>
        </div>
    </section>

    <!-- Town Selection Section -->
    <section class="town-selection-section">
        <div class="container">
            <h2>Explore Towns</h2>
            <p class="text-large">Choose a town to discover local businesses and hidden gems</p>
            
            <div class="town-grid">
                @foreach (var town in Model.AvailableTowns.Take(12))
                {
                    <a href="@Url.Action("TownBusinesses", "Member", new { townId = town.Id })" class="town-card">
                        <div class="town-card-content">
                            <h3>@town.Name</h3>
                            <p class="town-province">@town.Province</p>
                            @if (town.Population.HasValue)
                            {
                                <p class="town-population">Population: @town.Population.Value.ToString("N0")</p>
                            }
                        </div>
                        <div class="town-card-arrow">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                            </svg>
                        </div>
                    </a>
                }
            </div>

            @if (Model.AvailableTowns.Count > 12)
            {
                <div class="text-center" style="margin-top: 2rem;">
                    <a href="@Url.Action("Search", "Member")" class="btn btn-secondary">View All Towns</a>
                </div>
            }
        </div>
    </section>

    <!-- Featured Businesses Section -->
    @if (Model.FeaturedBusinesses.Any())
    {
        <section class="featured-businesses-section">
            <div class="container">
                <h2>Featured Businesses</h2>
                <p class="text-large">Discover top-rated businesses across South Africa</p>
                
                <div class="business-grid">
                    @foreach (var business in Model.FeaturedBusinesses)
                    {
                        @await Html.PartialAsync("_BusinessCard", business)
                    }
                </div>
                
                <div class="text-center" style="margin-top: 2rem;">
                    <a href="@Url.Action("Search", "Member")" class="btn btn-primary">Explore More Businesses</a>
                </div>
            </div>
        </section>
    }

    <!-- Recent Businesses Section -->
    @if (Model.RecentBusinesses.Any())
    {
        <section class="recent-businesses-section">
            <div class="container">
                <h2>Recently Added</h2>
                <p class="text-large">New businesses joining the TownTrek community</p>
                
                <div class="business-grid">
                    @foreach (var business in Model.RecentBusinesses)
                    {
                        @await Html.PartialAsync("_BusinessCard", business)
                    }
                </div>
            </div>
        </section>
    }

    <!-- Statistics Section -->
    <section class="member-stats-section">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üè™</div>
                    <span class="stat-number">@Model.TotalBusinessCount.ToString("N0")</span>
                    <span class="stat-label">Total Businesses</span>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üèòÔ∏è</div>
                    <span class="stat-number">@Model.AvailableTowns.Count</span>
                    <span class="stat-label">Towns Available</span>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ù§Ô∏è</div>
                    <span class="stat-number">@Model.UserFavorites.Count</span>
                    <span class="stat-label">Your Favorites</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Search Section -->
    <section class="quick-search-section">
        <div class="container">
            <div class="quick-search-card">
                <h2>Quick Search</h2>
                <p>Find exactly what you're looking for</p>
                
                <form asp-action="Search" asp-controller="Member" method="get" class="quick-search-form">
                    <div class="search-input-group">
                        <input type="text" name="search" placeholder="Search businesses, services, or locations..." class="form-input search-input" />
                        <button type="submit" class="btn btn-cta search-btn">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <circle cx="11" cy="11" r="8"/>
                                <path d="m21 21-4.35-4.35"/>
                            </svg>
                            Search
                        </button>
                    </div>
                </form>
                
                <div class="search-links">
                    <a href="@Url.Action("Search", "Member", new { category = "restaurants-food" })" class="search-link">
                        üçΩÔ∏è Restaurants
                    </a>
                    <a href="@Url.Action("Search", "Member", new { category = "shops-retail" })" class="search-link">
                        üõçÔ∏è Shops
                    </a>
                    <a href="@Url.Action("Search", "Member", new { category = "accommodation" })" class="search-link">
                        üè® Accommodation
                    </a>
                    <a href="@Url.Action("Search", "Member", new { category = "tours-experiences" })" class="search-link">
                        üó∫Ô∏è Tours
                    </a>
                </div>
            </div>
        </div>
    </section>
</div>

@section Scripts {
    <script src="~/js/modules/member/member-manager.js" asp-append-version="true"></script>
    <script>
        document.body.dataset.page = 'member-dashboard';
    </script>
}
