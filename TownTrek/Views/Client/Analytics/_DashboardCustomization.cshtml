@model TownTrek.Services.Interfaces.DashboardCustomizationResponse
@{
    var preferences = Model.Preferences;
}

<div class="dashboard-customization">
    <!-- Customization Header -->
    <div class="customization-header">
        <div class="header-content">
            <h3 class="section-title">
                <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                Dashboard Customization
            </h3>
            <p class="section-subtitle">Customize your analytics dashboard layout and preferences</p>
        </div>
    </div>

    <!-- Customization Controls -->
    <div class="customization-controls">
        <div class="controls-grid">
            <!-- Widget Visibility -->
            <div class="control-section">
                <h4 class="control-title">Widget Visibility</h4>
                <div class="widget-toggles">
                    <label class="toggle-item">
                        <input type="checkbox" id="showViewsCard" @(preferences.ShowViewsCard ? "checked" : "")>
                        <span class="toggle-label">Views Card</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="showReviewsCard" @(preferences.ShowReviewsCard ? "checked" : "")>
                        <span class="toggle-label">Reviews Card</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="showFavoritesCard" @(preferences.ShowFavoritesCard ? "checked" : "")>
                        <span class="toggle-label">Favorites Card</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="showEngagementCard" @(preferences.ShowEngagementCard ? "checked" : "")>
                        <span class="toggle-label">Engagement Card</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="showPerformanceChart" @(preferences.ShowPerformanceChart ? "checked" : "")>
                        <span class="toggle-label">Performance Chart</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="showViewsChart" @(preferences.ShowViewsChart ? "checked" : "")>
                        <span class="toggle-label">Views Chart</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="showReviewsChart" @(preferences.ShowReviewsChart ? "checked" : "")>
                        <span class="toggle-label">Reviews Chart</span>
                    </label>
                </div>
            </div>

            <!-- Layout Options -->
            <div class="control-section">
                <h4 class="control-title">Layout Options</h4>
                <div class="layout-options">
                    <label class="radio-item">
                        <input type="radio" name="layoutType" value="default" @(preferences.LayoutType == "default" ? "checked" : "")>
                        <span class="radio-label">Default Layout</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="layoutType" value="compact" @(preferences.LayoutType == "compact" ? "checked" : "")>
                        <span class="radio-label">Compact Layout</span>
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="layoutType" value="detailed" @(preferences.LayoutType == "detailed" ? "checked" : "")>
                        <span class="radio-label">Detailed Layout</span>
                    </label>
                </div>
            </div>

            <!-- Date Range -->
            <div class="control-section">
                <h4 class="control-title">Default Date Range</h4>
                <select id="defaultDateRange" class="form-select">
                    <option value="7" selected="@(preferences.DefaultDateRange == "7")">Last 7 days</option>
                    <option value="30" selected="@(preferences.DefaultDateRange == "30")">Last 30 days</option>
                    <option value="90" selected="@(preferences.DefaultDateRange == "90")">Last 90 days</option>
                    <option value="365" selected="@(preferences.DefaultDateRange == "365")">Last year</option>
                </select>
            </div>

            <!-- Auto-refresh -->
            <div class="control-section">
                <h4 class="control-title">Auto-refresh Interval</h4>
                <select id="refreshInterval" class="form-select">
                    <option value="0" selected="@(preferences.RefreshInterval == 0)">Disabled</option>
                    <option value="30" selected="@(preferences.RefreshInterval == 30)">30 seconds</option>
                    <option value="60" selected="@(preferences.RefreshInterval == 60)">1 minute</option>
                    <option value="300" selected="@(preferences.RefreshInterval == 300)">5 minutes</option>
                </select>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="customization-actions">
            <button type="button" id="savePreferences" class="btn btn-primary">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
                Save Preferences
            </button>
            <button type="button" id="resetToDefault" class="btn btn-secondary">
                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                Reset to Default
            </button>
        </div>
    </div>

    <!-- Saved Views -->
    <div class="saved-views-section">
        <div class="section-header">
            <h4 class="section-title">Saved Views</h4>
            <button type="button" id="saveCurrentView" class="btn btn-outline-primary btn-sm">
                <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                </svg>
                Save Current View
            </button>
        </div>

        @if (Model.SavedViews.Any())
        {
            <div class="saved-views-grid">
                @foreach (var savedView in Model.SavedViews)
                {
                    <div class="saved-view-card @(savedView.IsDefault ? "default" : "")" data-view-id="@savedView.Id">
                        <div class="view-header">
                            <h5 class="view-name">@savedView.Name</h5>
                            @if (savedView.IsDefault)
                            {
                                <span class="default-badge">Default</span>
                            }
                        </div>
                        <p class="view-description">@savedView.Description</p>
                        <div class="view-meta">
                            <span class="view-date-range">@savedView.DateRange days</span>
                            <span class="view-layout">@savedView.LayoutType</span>
                        </div>
                        <div class="view-actions">
                            <button type="button" class="btn btn-sm btn-primary load-view" data-view-id="@savedView.Id">
                                Load
                            </button>
                            @if (!savedView.IsDefault)
                            {
                                <button type="button" class="btn btn-sm btn-outline-primary set-default" data-view-id="@savedView.Id">
                                    Set Default
                                </button>
                            }
                            <button type="button" class="btn btn-sm btn-outline-danger delete-view" data-view-id="@savedView.Id">
                                Delete
                            </button>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <div class="empty-saved-views">
                <p>No saved views yet. Save your current dashboard configuration to get started.</p>
            </div>
        }
    </div>
</div>

<!-- Save View Modal -->
<div class="modal fade" id="saveViewModal" tabindex="-1" aria-labelledby="saveViewModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="saveViewModalLabel">Save Dashboard View</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="saveViewForm">
                    <div class="mb-3">
                        <label for="viewName" class="form-label">View Name</label>
                        <input type="text" class="form-control" id="viewName" required maxlength="100">
                    </div>
                    <div class="mb-3">
                        <label for="viewDescription" class="form-label">Description</label>
                        <textarea class="form-control" id="viewDescription" rows="3" maxlength="500"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-check-label">
                            <input type="checkbox" class="form-check-input" id="setAsDefault">
                            Set as default view
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="confirmSaveView">Save View</button>
            </div>
        </div>
    </div>
</div>
